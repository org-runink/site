{{ $json := .Inner | transform.Unmarshal }}
<section class="py-4">
  <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-center">
      <div class="inline-flex rounded-lg bg-stone-800 p-1 border border-stone-700" role="tablist"
        aria-label="Pricing toggle">
        {{ range $i, $opt := $json.options }}
        <button type="button"
          class="toggle-btn relative px-4 py-2 text-sm font-medium text-[#D9CDB8] rounded-md focus:outline-none focus-visible:ring-2 focus-visible:ring-[#8B9A6E]"
          data-value="{{ $opt.value }}" role="tab" aria-selected="false">
          {{ $opt.label }}
        </button>
        {{ end }}
      </div>
    </div>
  </div>
</section>

<script>
  (function () {
    var container = document.currentScript && document.currentScript.previousElementSibling;
    if (!container) return;
    var firstButtonGroup = container.querySelector('[role="tablist"]');
    if (!firstButtonGroup) return;
    var buttons = firstButtonGroup.querySelectorAll('button[data-value]');
    if (!buttons.length) return;

    function setActive(val) {
      document.documentElement.setAttribute('data-pricing', val);
      buttons.forEach(function (btn) {
        var isActive = btn.getAttribute('data-value') === val;
        btn.setAttribute('aria-selected', isActive ? 'true' : 'false');
        btn.classList.toggle('from-[#5F6F3E]', isActive);
        btn.classList.toggle('to-[#B87333]', isActive);
        btn.classList.toggle('bg-gradient-to-r', isActive);
        btn.classList.toggle('text-white', isActive);
        btn.classList.toggle('shadow-sm', isActive);
      });

      // Emit custom event
      try {
        var evt = new CustomEvent('pricing:toggle', { detail: { value: val } });
        document.dispatchEvent(evt);
      } catch (e) { /* no-op */ }
    }

    buttons.forEach(function (btn) {
      btn.addEventListener('click', function () { setActive(btn.getAttribute('data-value')); });
    });

    // Default to the first option
    if (buttons.length > 0) {
      setActive(buttons[0].getAttribute('data-value'));
    }
  })();
</script>